<!--
LICENSE
This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not
distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.

END LICENSE
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3c.org/1999/xhtml" xmlns:jsapi="http://www.inonit.com/jsapi">
<head>
	<title>jrunscript-based interaction with shell</title>
	<link rel="stylesheet" type="text/css" href="../../loader/api/api.css" />
	<script type="text/javascript" src="../../loader/api/api.js"></script>
</head>
<body>
	<div>
		<h1>Exports</h1>
		<ul jsapi:id="exports">
			<li class="function" jsapi:id="run">
				<div class="name"><a id="exports.run">run</a></div>
				<!--	TODO	document the 'on' property	-->
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol jsapi:id="arguments">
						<li class="object">
							<div class="label">has properties:</div>
							<ul>
								<li class="object">
									<div class="name">stdio</div>
									<span class="type"><a href="#types.stdio">stdio</a></span>
									<span>
										(optional: defaults to stream-specific results as specified)
										The streams that will be attached to the subprocess as its standard I/O streams. If the
										value is <code>null</code> the subprocess will receive empty input and all output will be
										discarded. Otherwise, the properties are interpreted for each stream as specified below.
									</span>
									<div class="label">has properties:</div>
									<ul>
										<li class="value">
											<div class="name">input</div>
											<ul>
												<li>
													If omitted or <code>null</code>, an empty stream is supplied as
													input.
												</li>
												<li>
													If a string, the string is supplied as input.
												</li>
												<li>
													If a <a href="../io/api.html#types.binput">byte stream</a>, the stream is supplied as input.
												</li>
											</ul>
										</li>
										<li class="value">
											<div class="name">output</div>
											<span>(optional; if omitted, a stream that discards all output is supplied.)</span>
											<ul>
												<li>
													If <code>null</code>, an stream that discards all output is supplied to the
													subprocess.
												</li>
												<li>
													If the <code>String</code> global function is supplied, subprocess output is
													buffered and converted to a string and is returned as the output property of the
													stdio property of the result of the subprocess.
												</li>
												<li>
													If a <a href="../io/api.html#types.boutput">byte stream</a>, output from the subprocess is sent to that stream.
												</li>
											</ul>
										</li>
										<li class="value">
											<div class="name">error</div>
											<span>See the <code>output</code> property for detailed specification.</span>
										</li>
									</ul>
								</li>
								<li class="value" jsapi:id="run.environment">
									<div class="name">environment</div>
									- OR -
									<div>
										<span class="type"><a href="../../loader/$api-Function.fifty.ts?as=text#types.mutator">mutator</a></span>
										<span>A mutator function which will receive the current process environment as its argument.</span>
									</div>
								</li>
								<li class="function" jsapi:id="run.evaluate">
									<div class="name"><a name="run.evaluate">evaluate</a></div>
									<div>
										A function that will be invoked when the subprocess terminates, will be provided with
										information about the result, and specifies the return value of <code>run</code>.
									</div>
									<div>
										If this property is omitted, a default will be used that throws an exception if the
										exit status of the subprocess is not zero or the subprocess cannot be launched, and returns
										its argument.
									</div>
									<div class="arguments">
										<div class="label">Arguments</div>
										<ol>
											<li class="object">
												<div class="label">has properties:</div>
												<ul>
													<li class="value">
														<div class="name">status</div>
														<span class="type">number</span>
														<span>The exit status of the subprocess, if it was launched successfully.</span>
													</li>
													<li class="value">
														<div class="name">error</div>
														<span class="type">JavaClass java.lang.Throwable</span>
														<span>The <code>java.lang.Throwable</code> that was thrown by the Java
														virtual machine when attempting to execute the subprocess, if it was not
														successfully launched.</span>
													</li>
													<li class="value">
														<div class="name">command</div>
														<span>The program that was run.</span>
													</li>
													<li class="value">
														<div class="name">arguments</div>
														<span class="type">Array</span>
														<span>The arguments that were passed to the program.</span>
													</li>
													<li class="value">
														<div class="name">environment</div>
														<span class="type">object</span>
														<span>
															(optional)
															The environment that was passed to the program, if any.
														</span>
													</li>
													<li class="value">
														<div class="name">directory</div>
														<span>
															(optional)
															The working directory that was specified for running the
															program, if any.
														</span>
													</li>
													<li class="object">
														<div class="name">stdio</div>
														<span>
															(optional)
															The output of the subprocess, if the caller specified that it should be
															buffered and returned.
														</span>
														<div class="label">has properties:</div>
														<ul>
															<li class="value">
																<div class="name">output</div>
																<span class="type">string</span>
																<span>
																	(optional)
																	The output of the subprocess, if it was buffered.
																</span>
															</li>
															<li class="value">
																<div class="name">error</div>
																<span class="type">string</span>
																<span>
																	(optional)
																	The output of the subprocess that was written to the error
																	stream, if it was buffered.
																</span>
															</li>
														</ul>
													</li>
													<!--	TODO	is there any reason not to return stdio?	-->
												</ul>
											</li>
										</ol>
									</div>
									<div class="returns">
										<div class="label">Returns</div>
										<span class="type">(any)</span>
										<span>An arbitrary value to return as the return value of <code>run</code>.</span>
									</div>
								</li>
							</ul>
						</li>
						<li class="object">
							<span>An event handler.</span>
							<div class="label">has properties:</div>
							<ul>
								<li class="value">
									<div class="name">start</div>
									<span class="type">__TYPE__</span>
									<span>Invoked when a process starts, with detail:</span>
									<div class="label">has properties:</div>
									<ul>
										<li class="value">
											<div class="name">command</div>
											<span class="type">__TYPE__</span>
											<span>__DESCRIPTION__</span>
										</li>
										<li class="value">
											<div class="name">arguments</div>
											<span class="type">__TYPE__</span>
											<span>__DESCRIPTION__</span>
										</li>
										<li class="value">
											<div class="name">environment</div>
											<span class="type">__TYPE__</span>
											<span>__DESCRIPTION__</span>
										</li>
										<li class="value">
											<div class="name">directory</div>
											<span class="type">__TYPE__</span>
											<span>__DESCRIPTION__</span>
										</li>
									</ul>
								</li>
							</ul>
						</li>
					</ol>
				</div>
				<div class="returns" jsapi:id="returns">
					<div class="label">Returns</div>
					<span class="type">(any)</span>
					<span>
						The value returned by the function given as the <code>evaluate</code> property of the argument, or
						by the default implementation of <code>evaluate</code>.
					</span>
				</div>
			</li>
			<li class="function" jsapi:id="jrunscript">
				<div class="name"><a id="exports.jrunscript">jrunscript</a></div>
				<span>Launches a JavaScript script on a Java virtual machine.</span>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li class="object">
							<span>
								An object based upon the argument to <a href="#exports.run">run()</a>.
								<!--	What do we do with the 'command' property?	-->
								The object has the following differences with that argument:
							</span>
							<div class="label">has properties:</div>
							<ul>
								<li class="value">
									<div class="name">arguments</div>
									<span class="type">Array of string</span>
									<span>
										Provides arguments to the script invocation (including the script as the first argument).
										These arguments will be augmented by those indicated by the
										<code>vmarguments</code> and <code>properties</code> properties below.
									</span>
								</li>
								<li class="value">
									<div class="name">vmarguments</div>
									<span class="type">Array of string</span>
									<span>An array of arguments to pass to the virtual machine running the script.</span>
								</li>
								<li class="value">
									<div class="name">properties</div>
									<span class="type">Object</span>
									<span>
										A set of system properties to pass to the underlying virtual machine. Each
										property of the object represents a system property; the property name is the system
										property name, and the property value is the value of that system property.
									</span>
								</li>
							</ul>
						</li>
					</ol>
				</div>
				<div class="returns">
					<div class="label">Returns</div>
					<span class="type">(any)</span>
					<span>A value determined in the same way as that of <a href="#exports.run">run()</a>.</span>
				</div>
			</li>
		</ul>
	</div>
</body>
</html>
