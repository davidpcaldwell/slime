<!DOCTYPE html>
<html>
	<head>
		<title>Specification Editor</title>
		<style>
			#target { width: 100%; height: 90vh; }
		</style>
		<script src="../../../loader/browser/client.js"></script>
		<script>
			window.addEventListener('load', function() {
				//	TODO	CORS
				document.domain = document.domain;

				var xhr = new XMLHttpRequest();
				xhr.open("GET","../../../../$reload",false);
				xhr.send();
				
				var xhr = new XMLHttpRequest();
				xhr.open("GET","../../../../",false);
				xhr.send();
				var settings = JSON.parse(xhr.responseText);
				document.getElementById("target").addEventListener("load", function(e) {
				});
				document.getElementById("target").src = window.location + "../../../../../../filesystem/" + settings.api.substring(1);

				var base = inonit.loader.base.split("/").slice(0,-3).join("/") + "/";

				if (settings.debug) {
					var loader = new inonit.loader.Loader(base);
					loader.run("slime/jsh/unit/specify/index.html.test.js", {
						$loader: new loader.Child("slime/")
					});
				}
			});
		</script>
	</head>
	<body>
		<div>Your specification</div>
		<iframe id="target"></iframe>
	</body>
</html>
