<html>
<head>
	<title>jsh Launcher</title>
</head>
<body>
	<div>
		<h1>Java launcher (inonit.script.jsh.launcher.Main)</h1>
		<div>
			<h2>Resources used</h2>
			<ul>
				<li>main.jsh: If present in classpath, this is a packaged application.</li>
				<li>
					jsh.jar: If <code>inonit.script.jsh.launcher.Main</code> loaded from a file named <code>jsh.jar</code>, we
					assume we can find js.jar and jsh.rhino.js at their typical relative locations (unless otherwise specified).
				</li>
			</ul>
			<h2>Environment variables used</h2>
			<ul>
				<li>
					JSH_LAUNCHER_DEBUG: If set, launcher script will run inside debugger, and additional debugging
					information will be output to console.
				</li>
				<li>
					JSH_RHINO_CLASSPATH: if present, specifies location of js.jar; otherwise, if running inside
					shell, location is inferred from location of jsh.jar. In packaged application, location of js.jar does not
					apply. If Cygwin is present, assumed to be in Cygwin format.
				</li>
				<li>
					JSH_RHINO_SCRIPT: specifies location of jsh.rhino.js (location of api.rhino.js is inferred from this).
					Otherwise, location is inferred from location of jsh.jar.
				</li>
			</ul>
		</div>
		<h1>Rhino script</h1>
		<h2>api.rhino.js</h2>
		<p>
			Also used by jsh/etc/build.rhino.js
		</p>
		<h2>jsh.rhino.js (and api.rhino.js)</h2>
		<div>
			Required in classpath: rhino/system/java
			<div>
				Environment variables used:
				<p>
					All environment variables beginning with <code>JSH_</code>, along with the <code>PATH</code> variable, are also
					used to pass to the loader as-is, as system properties named <code>jsh.launcher.environment.<i>name</i></code>.
				</p>
				<ul>
					<li>
						JSH_LAUNCHER_DEBUG: If set, launcher emits additional debugging information to console.
					</li>
					<li>
						JSH_JAVA_HOME: If set, this value is used for locating JDK libraries specified by the script, and also is
						used to execute the jsh loader main class. Otherwise, the Java installation executing the launcher is
						used.
					</li>
					<li>
						JSH_SHELL_CLASSPATH: If set, this path is used to supply the jsh loader with the classes normally contained
						in lib/jsh.jar.
					</li>
					<li>
						JSH_SCRIPT_CLASSPATH: If set, this path is used to supply the jsh loader with additional Java libraries on 
						the classpath.
					</li>
					<li>
						JSH_LIBRARY_MODULES, JSH_LIBRARY_SCRIPTS_LOADER, JSH_LIBRARY_SCRIPTS_RHINO, JSH_LIBRARY_SCRIPTS_JSH: if
						present, values are passed to jsh loader as properties: a property is created by converting the name of the
						environment variable to lowercase and replacing underscores with periods to create a name, and the value is
						set to the value of the environment variable.
					</li>
					<li>
						JSH_TMPDIR: if present, value is supplied as the <code>java.io.tmpdir</code> property to the loader.
					</li>
					<li>
						JSH_LIBRARY_NATIVE: if running on Cygwin, the value is used to locate the Cygwin paths helper application,
						and the location of that application is passed to the jsh loader as property <code>cygwin.paths</code>.
					</li>
					<li>
						JSH_OPTIMIZATION: If present, value is passed to jsh loader as property <code>jsh.optimization</code>.
					</li>
					<li>
						JSH_SCRIPT_DEBUGGER: If present, value is passed to jsh loader as property <code>jsh.script.debugger</code>.
					</li>
					<li>
						PATH: Is used to locate the target script if only a file name is supplied.
					</li>
					<li>
						JSH_JVM_OPTIONS: If present, is used as space-delimited set of options to supply to the jsh loader.
					</li>
					<li>
						JSH_JAVA_DEBUGGER: If present, the JVM process executing the jsh loader main class is run in a debugger.
					</li>
				</ul>
			</div>
			<div>
				System properties used by Main.java to communicate with jsh.rhino.js:
				<p>
					All properties beginning with <code>jsh.launcher.</code> are also passed as-is to subprocesses.
				</p>
				<ul>
					<li>
						<code>jsh.launcher.packaged</code>: If present, indicates that the shell is running within a packaged
						application.
					</li>
					<li>
						<code>jsh.launcher.rhino.classpath</code>: Indicates the location of the Rhino interpreter to be used to
						execute the jsh loader.
					</li>
					<li>
						<code>jsh.launcher.home</code>: If present, used to locate the platform modules, SLIME loader, Rhino SLIME 
						loader, jsh SLIME loader, and native libraries directory (assuming the locations of these are not specified
						using environment variables).
					</li>
					<li>
						<code>jsh.launcher.classpath</code>: classpath from which jsh launcher was loaded, to pass to loader.
					</li>
					<li><code>jsh.launcher.rhino.script</code>: location of jsh.rhino.js, to pass to loader.</li>
				</ul>
			</div>
			<div>
				System properties used:
				<ul>
					<li>
						<code>java.home</code>: if JSH_JAVA_HOME is not specified, used to execute the jsh loader.
					</li>
					<li>
						<code>java.class.path</code>: Supplied to the jsh loader to provide the Rhino interpreter if
						<code>jsh.launcher.rhino.classpath</code> is not present. Also provides the jsh loader classes if this
						application is a packaged application.
					</li>
				</ul>
			</div>
		</div>
	</div>
</body>
</html>
