<!--
LICENSE
This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not
distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.


The Original Code is the SLIME project.

The Initial Developer of the Original Code is David P. Caldwell <david@davidpcaldwell.com>.
Portions created by the Initial Developer are Copyright (C) 2018 the Initial Developer. All Rights Reserved.

Contributor(s):
END LICENSE
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:jsapi="http://www.inonit.com/jsapi">
	<head>
		<title>SLIME: development</title>
		<link href="../loader/api/api.css" rel="stylesheet" type="text/css" />
		<script>
			window.slime = {
				definition: {
					settings: {
						isHomePage: true
					}
				}
			}
		</script>
		<script src="../loader/api/api.js"></script>
		<script>
			//	TODO	CORS
			document.domain = document.domain;
		</script>
	</head>
	<body>
		<h1>SLIME: Contributing</h1>
		<div>This page contains resources for developing SLIME itself.</div>
		<div>
			<h2><a href="../local/doc/typedoc/interfaces/slime.project.wf.interface.html"><code>wf</code> Commands</a></h2>
		</div>
		<div>
			<h2>Project Management</h2>
			<h3><a href="https://github.com/davidpcaldwell/slime/issues?q=is%3Aissue+is%3Aopen+no%3Aproject">Issues with no assigned project</a></h3>
			<p>
				Can assign the <code>backlog</code> milestone when no milestone applies.
			</p>
			<a href="https://github.com/davidpcaldwell/slime/projects?query=is%3Aopen+sort%3Aname-asc">Projects</a>
		</div>
		<div>
			<h2>Low-level structure</h2>
			<div>
				<h3><a href="../local/doc/typedoc/modules/slime.runtime.html">SLIME Runtime</a> (<code><a href="../loader/expression.js">loader/expression.js</a></code>)</h3>
			</div>
			<div>
				<h3><a href="../loader/jrunscript/api.html">SLIME Java runtime</a></h3>
			</div>
		</div>
		<div>
			<h2>Shell: <code>jsh</code></h2>
			<div>
				<h3><a href="../jsh/launcher/internal.api.html">Launcher</a> documentation</h3>
			</div>
			<div>
				<h3><a href="../jsh/loader/internal.api.html">Loader</a> documentation</h3>
			</div>
		</div>
		<div>
			<h2>Tests</h2>
			<div>
				<h3><code><a href="suite.jsh.js">contributor/suite.jsh.js</a></code></h3>
				Runs all tests, installing Tomcat into the shell if necessary so that browser (and servlet) tests can be run.
				<div>
					<h3><code>./wf docker.test</code></h3>
					Runs the suite in Docker, which currently does not work.
				</div>
			</div>
			<div>
				The suite runs:
				<ul>
					<li><code><a href="jrunscript-engines.jsh.js">contributor/jrunscript-engines.jsh.js</a></code>,</li>
					<li><code><a href="jrunscript.jsh.js">contributor/jrunscript.jsh.js</a></code>,</li>
					<li><code><a href="loader/browser/suite.js">loader/browser/suite.js</a></code>,</li>
					<li>A series of tests on development tools.</li>
				</ul>
			</div>
			<div>
				<h3>Running the browser suite</h3>
				<div>
					<code>
						<a href="../loader/browser/test/suite.jsh.api.html">loader/browser/test/suite.jsh.js</a>
						-suite <a href="../loader/browser/suite.js">loader/browser/suite.js</a>
					</code>
				</div>
			</div>
			<div>
				<h3>Running subsuites, in whole or in part</h3>
				<ul>
					<li>
						Java tests:
						<code><a href="jrunscript.jsh.js">contributor/jrunscript.jsh.js</a>
							[-view <i>view</i>]
							[-part <i>suitepath[:pagepath]</i>]
							[-noselfping] [-executable]
						</code>
					</li>
				</ul>
			</div>
		</div>
		<div>
			<h2>Features</h2>
			<div>
				<h3>Built <code>jsh</code> shells</h3>
				<div>
					<code>./jsh.bash jsh/test/tools/run-in-built-shell.jsh.js <i>script</i> [<i>arguments</i>]</code>.
				</div>
			</div>
			<div>
				<h3>Remote <code>jsh</code> shells</h3>
				<div>
					See <a href="../jsh/tools/provision/test/plugin.jsh.api.html"><code>jsh.test.provision</code></a>.
				</div>
			</div>
		</div>
		<div>
			<h2>Manual testing required</h2>
			<div>
				<h3>Provisioning</h3>
				<div>
					<code>jrunscript rhino/jrunscript/api.js jsh jsh/tools/provision/test/server.jsh.js</code>
				</div>
				<div>
					Test: copy and paste the <samp>Testing (standard)</samp> output and make sure it produces a Hello, World message.
				</div>
				<div>
					Testing private repositories requires the private <code>slime-kit</code> repository, and can be invoked as
					follows:
					<div>
						<code>-repository:name slime-kit -repository:location <i>directory where slime-kit is located</i> -repository:script test/provision-script.jsh.js -password <i>password for server to use for davidpcaldwell</i></code>
					</div>
				</div>
			</div>
			<div>
				<h3>Google Chrome integration</h3>
				<div>
					<code>rhino/shell/test/manual/chrome.jsh.js</code>
					<ul>
						<li><code>profile</code></li>
						<li><code>app</code></li>
						<li><code>close [-exitOnClose]</code>: allows testing the detection of Google Chrome closing. On OS X, the
							<code>-exitOnClose</code> flag will attempt to terminate Chrome when the last window for the
							user data directory closes. Upon closure, a message will be printed to the console announcing Chrome
							has closed.
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div>
			<h2>Specifying Dependencies</h2>
			<div>
				<h3>JDK</h3>
				<div>
					<h4>JDK 8</h4>
					See <a href="https://github.com/corretto/corretto-8/releases">Amazon Corretto 8</a> site and then update
					<code>./jsh.bash</code> in two places (URL and basename).
				</div>
				<div>
					<h4>JDK 11</h4>
					See <a href="https://github.com/corretto/corretto-11/releases">Amazon Corretto 11</a> site and then update
					<code>./jsh.bash</code>.
				</div>
				<div>
					<h4>Old</h4>
					<ul>
						<li>JDK: <code>jsh/tools/provision/jdk.bash</code></li>
					</ul>
				</div>
			</div>
			<div>
				<h3>Rhino</h3>
				<p>
					Rhino is currently downloaded and installed as part of the <code>jrunscript</code> API
					(see <a href="../rhino/jrunscript/api.js"><code>rhino/jrunscript/api.js</code></a>, specifically
					<code>$api.rhino.download()</code>)
					in order to
					preserve the ability to restore support for older JDKs (6 or 7, where the built-in engine cannot
					run the loader, so the launcher would need to install it).
				</p>
				<p>
					The implementation could be simplified at the cost of making it harder to restore support for JDK 6 and
					7. Relying on the shell to install Rhino would also increase reliance on the deprecated Nashorn, which
					would be running the shell that installed Rhino.
				</p>
			</div>
			<div>
				<h3>Nashorn</h3>
				<p>
					<code>jsh</code> presently depends on the Nashorn bundled with the JDK on which it is running.
				</p>
				<div>
					<h4><code>ncdbg</code></h4>
					<p>
						The version of <code>ncdbg</code> is specified in
						<a href="../jsh/tools/install/plugin.jsh.js"><code>jsh/tools/install/plugin.jsh.js</code></a>.
					</p>
				</div>
			</div>
		</div>
		<div>
			<h2><a href="typescript.api.html">TypeScript</a></h2>
		</div>
		<div>
			<h2>VM Testing</h2>
			<div>
				<h3>Linux</h3>: Ubuntu 20.04.2.0
				<ul>
					<li>VMWare</li>
					<li>Do not use "Easy Install"</li>
					<li>Legacy BIOS</li>
					<li>
						Customize Settings
						<ul>
							<li>Save As: slime-linux</li>
							<li>Sharing
								<ul>
									<li>Enable Shared Folders</li>
									<li>Add source folder with name <code>slime</code> and read/write access</li>
								</ul>
							</li>
						</ul>
					</li>
					<li>
						Installation Wizard
						<ul>
							<li>
								English | Install Ubuntu
							</li>
							<li>
								English (US) - English (US)
							</li>
							<li>
								Minimal installation; Install third-party software: <strong>true</strong>
							</li>
							<li>
								Erase disk and install Ubuntu
							</li>
							<li>
								Where are you? New York
							</li>
							<li>
								<ul>
									<li>Your name: SLIME Linux Testbed</li>
									<li>Your computer's name: slime-linux</li>
									<li>Pick a user name: slime</li>
									<li>Choose a password: slime</li>
									<li>Confirm your password: slime</li>
									<li>Log in automatically</li>
								</ul>
							</li>
							<li>
								(Remove installation CD and reboot)
							</li>
							<li>
								Connect Your Online Accounts: skip
							</li>
							<li>
								Livepatch: Next
							</li>
							<li>
								Help improve Ubuntu: Yes
							</li>
							<li>
								You're ready to go! Done
							</li>
							<li>
								Install VMWare Tools
								<ul>
									<li>sudo apt install open-vm-tools</li>
									<li>sudo apt install open-vm-tools-desktop</li>
								</ul>
							</li>
							<li>
								Terminal
								<ul>
									<li>sudo apt-get update</li>
									<li>sudo apt install git</li>
									<li>git clone https://[user]@github.com/davidpcaldwell/slime src</li>
									<li>cd /mnt/hgfs/slime</li>
									<li>./wf test</li>
								</ul>
							</li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
		<div>
			<h2>Work In Progress</h2>
			<div>
				<h3><a href="../loader/api/test/fifty/README.html">Fifty</a></h3>
			</div>
			<div>
				<h3>GraalVM</h3>
				<div>
					To install: from script <code>jsh.shell.tools.graal.install()</code>, or from command line
					<code>./jsh.bash jsh/tools/install/graal.jsh.js</code>.
				</div>
				<div>
					To run sample script:
					<code>env JSH_ENGINE=graal ./jsh.bash jsh/test/jsh-data.jsh.js</code>
				</div>
				<div>
					To run sample script in debugger:
					<code>env JSH_ENGINE=graal JSH_DEBUG_SCRIPT=graal ./jsh.bash jsh/test/jsh-data.jsh.js</code>
				</div>
			</div>
			<div>
				<h3><a href="../loader/document/api.html">loader/document</a> (HTML parsing)</h3>
				<div>
					Goal would be to replace DOM in loader/browser/test/api.js and JaspiHtml in jsh/unit/html.js; this feeds into
					loader/api/api.html.js as the <code>html</code> argument to ApiHtmlTests.
				</div>
				<div>
					First step should be to build an adapter at loader/api/document-adapter.js that converts a loader/document
					document into a JSAPI-compatible html object. An additional property can be added to jsh/unit/html.js
					PartDescriptor argument to specify the creation of this new kind of document in loadApiHtml().
				</div>
				<div>
					Test case which runs the above scenario:
					<code>./jsh.bash loader/document/test/suite.jsh.js -experimental -part document</code>
				</div>
				<div>
					An equivalent browser migration for replacing the JSAPI DOM in loader/browser/test/api.js is then needed.
				</div>
				<div>
					<h4><a href="https://jsoup.org/">JSoup</a></h4>
					<a href="https://jsoup.org/apidocs/overview-summary.html">API</a>
				</div>
				<div>
					<h4><a href="../loader/document/source.api.html">Source-level parser</a></h4>
				</div>
			</div>
		</div>
	</body>
</html>

