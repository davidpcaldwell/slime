<!--
LICENSE
This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not
distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.


The Original Code is the SLIME loader infrastructure.

The Initial Developer of the Original Code is David P. Caldwell <david@davidpcaldwell.com>.
Portions created by the Initial Developer are Copyright (C) 2015 the Initial Developer. All Rights Reserved.

Contributor(s):
END LICENSE
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xmlns:jsapi="http://www.inonit.com/jsapi">
	<head>
		<title>__TITLE__</title>
		<!--	TODO	change these to use local copies of these files at the appropriate location	-->
		<link href="api.css" rel="stylesheet" type="text/css" />
		<script src="api.js"></script>
	</head>
	<body jsapi:id="top">
		<script type="application/x.jsapi#initialize">
			scope.module = $jsapi.loader.module("unit.js");
		</script>
		<div>__DESCRIPTION__</div>
		<!--	TODO	investigate $context.asynchronous	-->
		<!--
		<div>
			<h1>Context</h1>
			<ul>
			</ul>
		</div>
		-->
		<div>
			<h1>Exports</h1>
			<div class="type">
				<a class="type" name="types.Verify">Verify</a>
				<span>__DESCRIPTION__</span>
				<div class="label">has properties:</div>
				<ul>
				</ul>
				<script type="application/x.jsapi#tests">
					var s = {
						test: function() {
							test.apply(scope,arguments);
						}
					};
					var v = new module.Verify(s);
					v(1).is(1);
					v("x").length.is(1);
					var withHidden = { is: "hey", evaluate: "dude" };
					v(withHidden,"withHidden").evaluate.property("is").is("hey");
					v(withHidden,"withHidden").evaluate.property("evaluate").is("dude");
				</script>
			</div>

			<div class="type">
				<a class="type" name="types.Scenario">Scenario</a>
				<span>__DESCRIPTION__</span>
				<div class="type">
					<a class="type" name="types.Scenario.definition">definition</a>
					<span>An object specifying a <a href="#types.Scenario">Scenario</a>.</span>
					<div class="label">has properties:</div>
					<ul>
						<li class="value">
							<div class="name">name</div>
							<span class="type">string</span>
							<span>__DESCRIPTION__</span>
						</li>
						<li class="function">
							<div class="name">initialize</div>
							<span>__DESCRIPTION__</span>
							<div class="arguments">
								<div class="label">Arguments</div>
								<ol>
									<li class="value">
										<span class="type">object</span>
										<span>scope</span>
									</li>
								</ol>
							</div>
						</li>
						<li class="function">
							<div class="name">execute</div>
							<span>__DESCRIPTION__</span>
							<div class="arguments">
								<div class="label">Arguments</div>
								<ol>
									<li class="value">
										<span class="type">object</span>
										<span>scope</span>
									</li>
									<li class="value">
										<span class="type">verify</span>
										<span>verify</span>
									</li>
								</ol>
							</div>
							<div class="returns">
								<div class="label">Returns</div>
								<span class="type">__TYPE__</span>
								<span>__DESCRIPTION__</span>
							</div>
						</li>
						<li class="function">
							<div class="name">destroy</div>
							<span>__DESCRIPTION__</span>
							<div class="arguments">
								<div class="label">Arguments</div>
								<ol>
									<li class="value">
										<span class="type">object</span>
										<span>scope</span>
									</li>
								</ol>
							</div>
							<div class="returns">
								<div class="label">Returns</div>
								<span class="type">__TYPE__</span>
								<span>__DESCRIPTION__</span>
							</div>
						</li>
					</ul>
				</div>
				<div class="label">has properties:</div>
				<script type="application/x.jsapi#initialize">
					scope.a = new module.Suite({
						name: "a",
						parts: {
							a: {
								name: "aname",
								execute: function(scope,verify) {
									verify(1).is(1);
								}
							}
						}
					});

					scope.b = new module.Suite({
						name: "b",
						parts: {
							a: {
								execute: function(scope,verify) {
									verify(1).is(1);
								}
							}
						}
					});
				</script>
				<ul>
					<li class="value">
						<div class="name">id</div>
						<span class="type">string</span>
						<span>The part <code>id</code> of this scenario within its parent.</span>
						<script type="application/x.jsapi#tests">
							verify(a).getParts().a.id.is("a");
							verify(b).getParts().a.id.is("a");
						</script>
					</li>
					<li class="value">
						<div class="name">name</div>
						<span class="type">string</span>
						<span>
							The name specified in the definition, if specified. Otherwise, the part <code>id</code> of this
							scenario within its parent.
						</span>
						<script type="application/x.jsapi#tests">
							verify(a).getParts().a.name.is("aname");
							verify(b).getParts().a.name.is("a");
						</script>
					</li>
				</ul>
			</div>

			<div class="type">
				<a class="type" name="types.Suite">Suite</a>
				<span>__DESCRIPTION__</span>
				<div class="type">
					<a class="type" name="types.Suite.definition">definition</a>
					<span>__DESCRIPTION__</span>
					<div class="label">has properties:</div>
					<ul>
						<li class="function">
							<div class="name">scenario</div>
							<span>__DESCRIPTION__</span>
							<div class="arguments">
								<div class="label">Arguments</div>
								<ol>
									<li class="value">
										<span class="type">string</span>
										<span>An identifier that uniquely identifies the scenario within the definition.</span>
									</li>
									<li class="value">
										<span class="type">scenario</span>
										<span>A scenario to add to this definition.</span>
									</li>
								</ol>
							</div>
							<div class="returns">
								<div class="label">Returns</div>
								<span class="type">__TYPE__</span>
								<span>__DESCRIPTION__</span>
							</div>
						</li>
						<li class="function">
							<div class="name">suite</div>
							<span>__DESCRIPTION__</span>
							<div class="arguments">
								<div class="label">Arguments</div>
								<ol>
								</ol>
							</div>
							<div class="returns">
								<div class="label">Returns</div>
								<span class="type">__TYPE__</span>
								<span>__DESCRIPTION__</span>
							</div>
						</li>
					</ul>
				</div>
				<div class="type">
					<a class="type" name="types.Suite.configuration">Suite.configuration</a>
					<span>__DESCRIPTION__</span>
					<div class="label">has properties:</div>
					<ul>
						<!--	id: used internally when adding parts, at least	-->
						<!--	getParts: used in determining internal structure	-->
						<li class="value">
							<div class="name">name</div>
							<span class="type">string</span>
							<span>If specified, will specify the <code>name</code> property of this suite.</span>
						</li>
						<li class="function">
							<div class="name">create</div>
							<span>
								A method that will be called with a <a href="#types.Suite.definition">definition</a> as <code>this</code>,
								and can add "parts" (suites and scenarios) to this suite.
							</span>
							<div class="arguments">
								<div class="label">Arguments</div>
								<ol>
								</ol>
							</div>
							<div class="returns">
								<div class="label">Returns</div>
								<span class="type">__TYPE__</span>
								<span>__DESCRIPTION__</span>
							</div>
						</li>
					</ul>
				</div>
				<div class="label">has properties:</div>
				<ul>
					<li class="value">
						<div class="name">id</div>
						<span class="type">string</span>
						<span>
							The part ID of this suite within its parent.
						</span>
					</li>
					<!--	getParts	-->
					<li class="value">
						<div class="name">name</div>
						<span class="type">string</span>
						<span>
							The <code>name</code> of this suite. The name may be specified by the <code>create</code>
							implementation used to create the suite. If it is not specified, and the suite is not a top-level suite,
							the <code>id</code> property of the suite will be used.
							<!--	
								TODO	otherwise, the string (top) is currently returned, but this logic should be moved up
										in the stack to the presentation layer
							-->
						</span>
					</li>
					<li class="function">
						<div class="name">run</div>
						<span>Executes this suite.</span>
						<div class="arguments">
							<div class="label">Arguments</div>
							<ol>
								<li class="object">
									<div class="name">__NAME__</div>
									<span>__DESCRIPTION__</span>
									<div class="label">has properties:</div>
									<ul>
										<li class="value">
											<div class="name">scope</div>
											<span class="type">object</span>
											<span>
												(optional; default is an empty object)
												A set of properties that will be passed to the parts of this test.
											</span>
										</li>
										<li class="value">
											<div class="name">path</div>
											<span class="type">Array of string</span>
											<span>
												(optional; default is an empty array)
												A list of part names that will be interpreted as a "path" to the part(s) to execute.
												For example, the array <code>["foo","bar"]</code> will lead to the <code>bar</code>
												part of the <code>foo</code> part of this suite being executed.
											</span>
										</li>
									</ul>
								</li>
							</ol>
						</div>
						<div class="returns">
							<div class="label">Returns</div>
							<span class="type">__TYPE__</span>
							<span>__DESCRIPTION__</span>
						</div>
					</li>
				</ul>
			</div>
			<div class="type">
				<a class="type" name="types.Scenario">Scenario</a>
				<span>__DESCRIPTION__</span>
				<div class="type">
					<a class="type" name="types.Scenario.console">console</a>
					<span>__DESCRIPTION__</span>
					<div class="label">has properties:</div>
					<ul>
					</ul>
				</div>
				<div class="label">has properties:</div>
				<ul>
					<li class="value">
						<div class="name">name</div>
						<span class="type">string</span>
						<span>__DESCRIPTION__</span>
					</li>
					<li class="function">
						<div class="name">add</div>
						<span>
							(conditional: not present if not a composite scenario)
						</span>
						<div class="arguments">
							<div class="label">Arguments</div>
							<ol>
							</ol>
						</div>
						<div class="returns">
							<div class="label">Returns</div>
							<span class="type">__TYPE__</span>
							<span>__DESCRIPTION__</span>
						</div>
					</li>
					<li class="function">
						<div class="name">run</div>
						<span>__DESCRIPTION__</span>
						<div class="arguments">
							<div class="label">Arguments</div>
							<ol>
								<li class="object">
									<span>__DESCRIPTION__</span>
									<div class="label">has properties:</div>
									<ul>
										<li class="value">
											<div class="name">console</div>
											<span class="type"><a href="#types.console">console</a></span>
											<span>__DESCRIPTION__</span>
										</li>
									</ul>
								</li>
							</ol>
						</div>
						<div class="returns">
							<div class="label">Returns</div>
							<span class="type">__TYPE__</span>
							<span>__DESCRIPTION__</span>
						</div>
					</li>
				</ul>
			</div>
			<ul>
				<li class="constructor">
					<div class="name"><a id="exports.Scenario">Scenario</a></div>
					<span>__DESCRIPTION__</span>
					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="object">
								<div class="name">__NAME__</div>
								<span>__DESCRIPTION__</span>
								<div class="label">has properties:</div>
								<ul>
									<li class="value">
										<div class="name">composite</div>
										<span class="type">boolean</span>
										<span>__DESCRIPTION__</span>
									</li>
									<li class="value">
										<div class="name">view</div>
										<span class="type">__TYPE__</span>
										<span>__DESCRIPTION__</span>
									</li>
									<li class="value">
										<div class="name">name</div>
										<span class="type">string</span>
										<span>__DESCRIPTION__</span>
									</li>
									<li class="function">
										<div class="name">initialize</div>
										<span>__DESCRIPTION__</span>
										<div class="arguments">
											<div class="label">Arguments</div>
											<ol>
											</ol>
										</div>
										<div class="returns">
											<div class="label">Returns</div>
											<span class="type">__TYPE__</span>
											<span>__DESCRIPTION__</span>
										</div>
									</li>
									<li class="function">
										<div class="name">test</div>
										<span>__DESCRIPTION__</span>
										<div class="arguments">
											<div class="label">Arguments</div>
											<ol>
											</ol>
										</div>
										<div class="returns">
											<div class="label">Returns</div>
											<span class="type">__TYPE__</span>
											<span>__DESCRIPTION__</span>
										</div>
									</li>
									<li class="function">
										<div class="name">destroy</div>
										<span>__DESCRIPTION__</span>
										<div class="arguments">
											<div class="label">Arguments</div>
											<ol>
											</ol>
										</div>
										<div class="returns">
											<div class="label">Returns</div>
											<span class="type">__TYPE__</span>
											<span>__DESCRIPTION__</span>
										</div>
									</li>
								</ul>
							</li>
						</ol>
					</div>
					<div class="instances">
						<div class="label">Instances</div>
						<span class="type">__TYPE__</span>
						<span>__DESCRIPTION__</span>
					</div>
				</li>
				<li class="constructor">
					<div class="name">Suite</div>
					<span>__DESCRIPTION__</span>
					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="value">
								<span class="type"><a href="#types.Suite.configuration">Suite.configuration</a></span>
								<span>__DESCRIPTION__</span>
							</li>
						</ol>
					</div>
					<div class="instances">
						<div class="label">Instances</div>
						<span class="type"><a href="#types.Suite">Suite</a></span>
						<span>__DESCRIPTION__</span>
					</div>
				</li>
				<script type="application/x.jsapi#tests">
					var top = new module.Suite({
						name: "top",
						parts: {
							child: {
								name: "child",
								execute: function(scope,verify) {
									verify.test(function() {
										return {
											success: true,
											message: "Hello, World!"
										}
									});
								}
							}
						}
					});
					var starts = [];
					var ends = [];
					var tests = [];
					top.listeners.add("scenario", function(e) {
						if (e.detail.start) {
							starts.push(e.detail);
							//	jsh.shell.echo("Start: " + e.detail.start.name);
						} else if (e.detail.end) {
							//	jsh.shell.echo("End: " + e.detail.end + " success=" + e.detail.success);
							ends.push(e.detail);
						}
					});
					top.listeners.add("test", function(e) {
						//	jsh.shell.echo("Test: " + e.detail.message);
						tests.push(e.detail);
					});
					top.run();
					verify(starts).length.is(2);
				</script>
				<script type="application/x.jsapi#tests">
					var top = new module.Suite({
						name: "top"
					});
					var starts = [];
					var ends = [];
					var tests = [];
					top.listeners.add("scenario", function(e) {
						if (e.detail.start) {
							starts.push(e.detail);
							//	jsh.shell.echo("Start: " + e.detail.start.name);
						} else if (e.detail.end) {
							//	jsh.shell.echo("End: " + e.detail.end + " success=" + e.detail.success);
							ends.push(e.detail);
						}
					});
					top.listeners.add("test", function(e) {
						//	jsh.shell.echo("Test: " + e.detail.message);
						tests.push(e.detail);
					});
					top.scenario("child", {
						create: function() {
							this.name = "child";

							this.execute = function(scope,verify) {
								verify.test(function() {
									return {
										success: true,
										message: "Hello, World!"
									}
								});
							}
						}
					});
					top.run();
					verify(starts).length.is(2);
				</script>
			</ul>
		</div>
	</body>
</html>