<!--
LICENSE
This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not
distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.

The Original Code is the SLIME portable MIME implementation.

The Initial Developer of the Original Code is David P. Caldwell <david@davidpcaldwell.com>.
Portions created by the Initial Developer are Copyright (C) 2013 the Initial Developer. All Rights Reserved.

Contributor(s):
END LICENSE
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:jsapi="http://www.inonit.com/jsapi">
<head>
	<title>SLIME MIME</title>
	<link rel="stylesheet" type="text/css" href="../loader/api/api.css" />
	<script src="../loader/api/api.js"></script>
</head>
<body>
	<script type="application/x.jsapi#initialize">
		scope.api = jsh.unit.$slime;
	</script>
	<div>A simple set of constructs that pertain to MIME that can run on any JavaScript engine.</div>
	<div>
		<h1>Context</h1>
		<ul>
		</ul>
	</div>
	<div>
		<div class="type" jsapi:id="type">
			<a class="type" name="types.type">type</a>
			<span>A MIME type.</span>
			<div class="label">has properties:</div>
			<ul>
				<li class="function">
					<div class="name">getMedia</div>
					<span>Returns the MIME media type for this type; for <code>text/plain</code>, returns <code>"text"</code>.</span>
					<div class="returns">
						<div class="label">Returns</div>
						<span class="type">string</span>
					</div>
				</li>
				<li class="function">
					<div class="name">getSubtype</div>
					<span>Returns the MIME subtype for this type; for <code>text/plain</code>, returns <code>"plain"</code>.</span>
					<div class="returns">
						<div class="label">Returns</div>
						<span class="type">string</span>
					</div>
				</li>
				<li class="function">
					<div class="name">getParameters</div>
					<span>
						Returns an object with property values of type <code>string</code>. Each property of the object represents a MIME type
						parameter of the form <code><i>name</i>=<i>value</i></code>. The preceding declaration would result in the returned object containing
						a property named <code><i>name</i></code> that had the value <code><i>value</i></code>.
					</span>
					<div class="returns">
						<div class="label">Returns</div>
						<span class="type">object</span>
					</div>
				</li>
				<li class="function">
					<div class="name">toString</div>
					<span>Returns a string representation of this MIME type, suitable for a MIME type declaration.</span>
					<div class="returns">
						<div class="label">Returns</div>
						<span class="type">string</span>
					</div>
				</li>
			</ul>
		</div>
		<h1>Exports</h1>
		<ul>
			<li class="constructor" jsapi:id="exports.Type">
				<div class="name"><a name="$exports.Type">Type</a></div>
				<span>Creates a MIME type from its parsed components.</span>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li class="value">
							<span class="type">string</span>
							<span>The MIME media type: for <code>text/plain</code>, <code>"text"</code>.</span>
						</li>
						<li class="value">
							<span class="type">string</span>
							<span>The MIME subtype: for <code>text/plain</code>, <code>"plain"</code>.</span>
						</li>
						<li class="value">
							<span class="type">object</span>
							<span>
								An object with properties that have <code>string</code> values. Each property of the object represents a MIME parameter that
								will be appended to the MIME type; the name of the property is the name of the parameter, while the value of the property is the
								value of the parameter.
							</span>
						</li>
					</ol>
				</div>
				<div class="instances">
					<div class="label">Instances</div>
					<span class="type"><a href="#types.type">type</a></span>
				</div>
				<div class="label">has properties:</div>
				<ul>
					<li class="function">
						<div class="name">parse</div>
						<span>Parses the given string, returning the appropriate MIME type object.</span>
						<div class="arguments">
							<div class="label">Arguments</div>
							<ol>
								<li class="value">
									<span class="type">string</span>
									<span>A MIME type.</span>
								</li>
							</ol>
						</div>
						<div class="returns">
							<div class="label">Returns</div>
							<span class="type"><a href="#types.type">type</a></span>
						</div>
						<script type="application/x.jsapi#tests">
							(function() {
								var string = "text/plain";
								var type = api.mime.Type.parse(string);
								verify(type).getMedia().is("text");
								verify(type).getSubtype().is("plain");
								verify(type).getParameters().is.type("object");
								verify(type).getParameters().evaluate(function(p) { return Object.keys(p); }).length.is(0);
							})();
						</script>
					</li>
					<li class="function">
						<div class="name">fromName</div>
						<span>Attempts to determine the MIME type of a resource given its name.</span>
						<div class="arguments">
							<div class="label">Arguments</div>
							<ol>
								<li class="value">
									<span class="type">string</span>
									<span>A resource name.</span>
								</li>
							</ol>
						</div>
						<div class="returns">
							<div class="label">Returns</div>
							<span class="type"><a href="#types.type">type</a></span>
							<span>The type determined from the name, or <code>undefined</code> if the type cannot be determined.</span>
						</div>
						<script type="application/x.jsapi#tests">
							verify(api.mime).Type.fromName("foo.js").toString().is("application/javascript");
							verify(api.mime).Type.fromName("foo.f").is(void(0));
						</script>
					</li>
				</ul>
				<script type="application/x.jsapi#tests"><![CDATA[
					var throwsError = function(b,f,message) {
						if ($jsapi.debug && $jsapi.debug.disableBreakOnExceptions) {
							f = $jsapi.debug.disableBreakOnExceptions(f);
						}
						return new function() {
							this.success = function() {
								try {
									f();
									return !b;
								} catch (e) {
									return b;
								}
							};

							this.message = function(success) {
								if (!success) return "Should have errored.";
								return "Errored as expected.";
							}
						};
					};

					var a;
					var b = null;

					test(throwsError(true, function() {
						new api.mime.Type(a, "plain");
					}, "First argument undefined"));
					test(throwsError(true, function() {
						new api.mime.Type(b, "plain");
					}, "First argument null"));
					test(throwsError(true, function() {
						new api.mime.Type("text", a);
					}, "Second argument undefined"));
					test(throwsError(true, function() {
						new api.mime.Type("text", b);
					}, "Second argument null"));
					test(throwsError(true, function() {
						new api.mime.Type("text", "plain", 2);
					}, "Arguments contain number."));
					test(throwsError(false, function() {
						new api.mime.Type("text", "plain");
					}, "Arguments valid."));
					test(new api.mime.Type("text", "plain").toString() == "text/plain");
				]]></script>
			</li>
		</ul>
	</div>
</body>
</html>