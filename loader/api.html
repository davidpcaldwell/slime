<!--
LICENSE
This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not
distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.

The Original Code is the SLIME loader infrastructure.

The Initial Developer of the Original Code is David P. Caldwell <david@davidpcaldwell.com>.
Portions created by the Initial Developer are Copyright (C) 2010-2013 the Initial Developer. All Rights Reserved.

Contributor(s):
END LICENSE
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:jsapi="http://www.inonit.com/jsapi">
<head>
	<title>Slime Loader and Module API</title>
	<link rel="stylesheet" type="text/css" href="api/api.css" />

	<script type="text/javascript" src="../loader/api/api.js"></script>
</head>
<body>
	<div jsapi:id="1">
		Generally speaking, the loader is responsible for loading code into an application. The loader generally executes each
		source file by supplying it with a <code>$context</code> object which provides whatever configuration information is
		needed by the source file and an <code>$exports</code> object to which the code can assign properties which will be visible
		to the application.
	</div>
	<div jsapi:id="2">
		Scripts loaded by the loader also have access to the <code>$platform</code> and <code>$api</code> objects described below,
		which provide information about the underlying platform and the ability for code to provide information about its own
		API.
	</div>
	<div jsapi:id="3">
		The loader can execute a single script using the <code>run</code> or <code>file</code> methods, or can execute a module
		(which can consist of multiple source files) using the <code>module</code> method.
	</div>
	<!--
	<div>
		<h1>Context</h1>
		<ul>
			<li class="object">
				<div class="name">flag</div>
				<div class="label">has properties:</div>
				<ul>
					<li class="function">
						<div class="name">warning</div>
						<p>
							A function that will be invoked when this package issues a warning because of a reference to a flagged
							property.
						</p>
						<div class="arguments">
							<div class="label">Arguments</div>
							<ol>
								<li class="object">
									<div class="label">has properties:</div>
									<ul>
										<li>
											<div class="name">target</div>
											The object with the flagged property.
										</li>
										<li>
											<div class="name">name</div>
											The name of the flagged property.
										</li>
										<li>
											<div class="name">get</div>
											The value of the flagged property if the access was an attempt to read its
											value, or <code>undefined</code> otherwise.
										</li>
										<li>
											<div class="name">set</div>
											The value to which the caller attempted to set the flagged property if the
											access was an attempt to set its value, or <code>undefined</code> otherwise.
										</li>
										<li>
											<div class="name">call</div>
											The arguments passed to the flagged function if the access was an attempt
											to call it as a function, or <code>undefined</code> otherwise.
										</li>
										<li>
											<div class="name">reason</div>
											The function that was used to flag the property.
										</li>
									</ul>
								</li>
							</ol>
						</div>
					</li>
				</ul>
			</li>
		</ul>
	</div>
	-->
	<div>
		<h1>$engine</h1>
		<p>
			The <code>$engine</code> object can be provided to the platform loader in order to provide additional capabilities the
			JavaScript engine may have.
		</p>
		<ul>
			<li class="object">
				<div class="name">Object</div>
				<span></span>
				<div class="label">has properties:</div>
				<ul>
					<li class="object">
						<div class="name">defineProperty</div>
						<span></span>
						<div class="label">has properties:</div>
						<ul>
							<li class="function">
								<div class="name">setReadOnly</div>
								<span>
									Should implement the behavior defined by
									<a href="#$platform.Object.defineProperty.setReadOnly"><code>$platform.Object.defineProperty.setReadOnly</code></a>.
								</span>
							</li>
						</ul>
					</li>
				</ul>
			</li>
			<li class="constructor">
				<div class="name">MetaObject</div>
				<span>
					Should implement the behavior defined by
					<a href="#$platform.MetaObject"><code>$platform.MetaObject</code></a>.
				</span>
			</li>
		</ul>
	</div>
	<div jsapi:id="$platform">
		<h1>$platform</h1>
		<div>
			When code is loaded by the loader, the loader provides the <code>$platform</code> object to that code in the scope.
			The <code>$platform</code> object provides information about
			the underlying JavaScript platform; the loaded code can use this information in its implementation.
		</div>
		<ul>
			<li class="object">
				<div class="name">Object</div>
				<span>An object containing properties describing the platform's capabilities for objects.</span>
				<div class="label">has properties:</div>
				<ul>
					<li class="object">
						<div class="name">defineProperty</div>
						<span>(optional) An object containing properties describing the platform's meta-object capabilities.</span>
						<div class="label">has properties:</div>
						<ul>
							<li class="value">
								<div class="name">accessor</div>
								<span class="type">boolean</span>
								<span>
									(optional) If <code>true</code>, the platform supports <code>__defineGetter__</code> and
									<code>__defineSetter__</code> as defined by Mozilla.
								</span>
							</li>
							<li class="value">
								<div class="name">ecma</div>
								<span class="type">boolean</span>
								<span>
									(optional) If <code>true</code>, the platform supports the ECMA-262 version 5
									<code>Object.defineProperty</code> method.
								</span>
							</li>
							<li class="function" jsapi:id="$platform.Object.defineProperty.setReadOnly">
								<div class="name"><a name="$platform.Object.defineProperty.setReadOnly">setReadOnly</a></div>
								<span>(optional) Sets whether a named property on an object is read-only.</span>
								<div class="arguments">
									<div class="label">Arguments</div>
									<ol>
										<li class="value">
											<span class="type">object</span>
											<span>An object.</span>
										</li>
										<li class="value">
											<span class="type">string</span>
											<span>The name of a property.</span>
										</li>
										<li class="value">
											<span class="type">boolean</span>
											<span>
												Whether the property should be read-only (<code>true</code>) or writable
												(<code>false</code>).
											</span>
										</li>
									</ol>
								</div>
								<script type="application/x.jsapi#tests"><![CDATA[
									var o = {};
									o.x = 3;
									test(o.x == 3);
									o.x = 4;
									test(o.x == 4);
									var setReadOnly = (function() {
										if ($platform.Object.defineProperty && $platform.Object.defineProperty.setReadOnly) {
											return $platform.Object.defineProperty.setReadOnly;
										}
									})();
									if (setReadOnly) {
										setReadOnly(o,"x",true);
										o.x = 5;
										test(o.x == 4);
										setReadOnly(o,"x",false);
										o.x = 5;
										test(o.x == 5);
									}
								]]></script>
							</li>
						</ul>
					</li>
				</ul>
			</li>
			<li class="object">
				<div class="name">java</div>
				<span>(optional) An object with properties describing the platform's Java/LiveConnect capabilities.</span>
				<div class="label">has properties:</div>
				<ul>
					<li class="function">
						<div class="name">getClass</div>
						<div class="arguments">
							<div class="label">Arguments</div>
							<ol>
								<li class="value">
									<span class="type">string</span>
									<span>A Java class name.</span>
								</li>
							</ol>
						</div>
						<div class="returns">
							<div class="label">Returns</div>
							<span class="type">JavaClass</span>
							<span>
								A <code>JavaClass</code> object representing the class with the given name, or <code>null</code>
								if no class by that name can be loaded.
							</span>
						</div>
					</li>
				</ul>
			</li>
			<li class="constructor">
				<div class="name"><a name="$platform.MetaObject">MetaObject</a></div>
				<span>(optional) A metaobject implementation.</span>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li class="object">
							<div class="label">has properties:</div>
							<ul>
								<li class="value">
									<div class="name">delegate</div>
									<span class="type">object</span>
									<span>
										A delegate object that will be used to supply implementations for properties in
										preference to using the meta-object implementations.
									</span>
								</li>
								<li class="function">
									<div class="name">get</div>
									<span>
										A function that will be called when one of this object's properties that is not defined
										by the delegate object is accessed. This object will be provided as the <code>this</code>
										argument.
									</span>
									<div class="arguments">
										<div class="label">Arguments</div>
										<ol>
											<li class="value">
												<span class="type">string</span>
												<span>A property name</span>
											</li>
										</ol>
									</div>
									<div class="returns">
										<div class="label">Returns</div>
										<span>A value for the named property.</span>
									</div>
								</li>
								<li class="function">
									<div class="name">set</div>
									<span>
										A function that will be called when one of this object's properties that is not defined by
										the delegate object is set. This object will be provided as the <code>this</code> argument.
									</span>
									<div class="arguments">
										<div class="label">Arguments</div>
										<ol>
											<li class="value">
												<span class="type">string</span>
												<span>A property name.</span>
											</li>
											<li class="value">
												<span>The value assigned to the named property.</span>
											</li>
										</ol>
									</div>
								</li>
							</ul>
						</li>
					</ol>
				</div>
				<div class="instances">
					<div class="label">Instances</div>
					<span class="type">object</span>
					<span>
						Returns an object that uses the given delegate object to supply properties, but uses the given
						getter and setter if the delegate is <code>null</code> or the delegate lacks the named property.
					</span>
				</div>
				<script type="application/x.jsapi#initialize">
					scope.MetaObject = $platform.MetaObject;
				</script>
				<script type="application/x.jsapi#tests" jsapi:id="$platform.MetaObject">
					if ($platform.MetaObject) {
						var doubler = function(name) {
							if (isNaN(Number(name))) {
								return name + name;
							} else {
								return Number(name) * 2;
							}
						}

						var a = new $platform.MetaObject({ get: doubler });
						test( a[1] == 2 );
						test( a.name == "namename" );

						var logger = new function() {
							var log = [];

							this.log = log;

							this.setter = function(name,value) {
								log.push({ target: this, name: name, value: value });

								this[name] = value;
							}
						}

						var $b = {};
						var b = new $platform.MetaObject({ delegate: $b, get: null, set: logger.setter });
						b.foo = "bar";
						test( logger.log[0].target == $b );
						test( logger.log[0].name == "foo" );
						test( logger.log[0].value == "bar" );
					}
				</script>
			</li>
		</ul>
	</div>
	<div jsapi:id="$api">
		<h1>$api</h1>
		<div>
			The <code>$api</code> object is also provided to code loaded by the platform loader. It provides capabilities for
			defining APIs.
		</div>
		<ul>
			<li class="function">
				<div class="name"><a name="$api.deprecate">deprecate</a></div>
				<span>
					A function that can be used to mark a named property on an object as a deprecated API.
				</span>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li class="value">
							<span class="type">function</span>
							<span>A function to mark.</span>
						</li>
					</ol>
					-or-
					<ol>
						<li class="value">
							<span class="type">object</span>
							<span>A target object whose property will be marked.</span>
						</li>
						<li class="value">
							<span class="type">string</span>
							<span>
								(optional) The name of the property to mark. If omitted, <strong>all</strong> properties will be
								marked.
							</span>
						</li>
					</ol>
				</div>
				<div class="returns">
					<div class="label">Returns</div>
					<span class="type">function</span>
					-or-
					<span class="type">undefined</span>
					<span>
						If the argument was a function, returns a version of the function that is deprecated: that is, executes
						the appropriate warning callback when it is executed. Otherwise, returns undefined.
					</span>
				</div>
				<ul>
					<li class="function">
						<div class="name">warning</div>
						<span>
							(optional) A callback function that will be invoked when a marked property is accessed or marked
							function is called, or when a call to <code>deprecate</code> is made with invalid arguments.
						</span>
						<div class="arguments">
							<div class="label">Arguments</div>
							<ol>
								<li class="object">
									<span>Represents a single usage of a marked API.</span>
									<div class="label">has properties:</div>
									<ul>
										<li class="value">
											<div class="name">reason</div>
											<span class="type">function</span>
											<span>
												The reason that the API was marked: in the case of deprecation, a
												reference to the <code>deprecate</code> function itself.
											</span>
										</li>
										<!--
										TODO	Single-argument form deprecating a function
										<li class="value">
											<div class="name">function</div>
											<span class="type">function</span>
											<span>__DESCRIPTION__</span>
										</li>
										-->
										<li class="value">
											<div class="name">object</div>
											<span class="type">object</span>
											<span>(if object was specified) The object containing the marked property.</span>
										</li>
										<li class="value">
											<div class="name">property</div>
											<span class="type">string</span>
											<span>(if object was specified) The name of the marked property.</span>
										</li>
										<li class="value">
											<div class="name">callee</div>
											<span class="type">function</span>
											<span>(if deprecated item is function) A reference to the deprecated function.</span>
										</li>
										<li class="value">
											<div class="name">target</div>
											<span class="type">object</span>
											<span>
												(if deprecated item is function) The <code>this</code> value when the deprecated
												function was invoked.
											</span>
										</li>

										<li class="value">
											<div class="name">arguments</div>
											<span class="type">Array</span>
											<span>
												(if deprecated item is function) The contents of the <code>arguments</code> object
												passed to the function; note that this object is an array, not the
												<code>arguments</code> object.
											</span>
										</li>
										<li class="value">
											<div class="name">get</div>
											<span>
												(if deprecated item is non-function) The value of the marked property when it was
												accessed, if this usage was
												a retrieval of the value of a marked property.
											</span>
										</li>
										<li class="value">
											<div class="name">set</div>
											<span>
												(if deprecated item is non-function) The value to which the deprecated property was set, if this usage was an
												assignment to a marked property.
											</span>
										</li>
										<li class="value">
											<div class="name">flag</div>
											<span class="type">Array</span>
											<span>
												(when invalid arguments sent to deprecate) The arguments passed to deprecate that
												did not identify a valid function or property to deprecate.
											</span>
										</li>
									</ul>
								</li>
							</ol>
						</div>
					</li>
				</ul>
				<script jsapi:id="deprecate.function" type="application/x.jsapi#tests"><![CDATA[
					var was = $api.deprecate.warning;
					var called = 0;
					var warnings = 0;
					var f = function() {
						called++;
						return called;
					};
					var warning = function(p) {
						test(p.callee == f);
						warnings++;
					};
					$api.deprecate.warning = warning;

					var deprecated = $api.deprecate(f);

					test(f() == 1 && warnings == 0);
					test(deprecated() == 2);
					test(warnings == 1);
					test(deprecated() == 3);
					test(warnings == 2);
					$api.deprecate.warning = was;
				]]></script>
				<script jsapi:id="deprecate.object" type="application/x.jsapi#tests"><![CDATA[
					var was = $api.deprecate.warning;
					var called = 0;
					var warnings = [];
					var warning = function(p) {
						warnings.push(p);
					}
					$api.deprecate.warning = warning;
					var o = new function() {
						this.p = 1;
						this.m = function() {
							return 2;
						};
					};
					var rv = $api.deprecate(o);
					test(typeof(rv) == "undefined");
					var p = o.p;
					test(p == 1);
					var m = o.m();
					test(m == 2);
					test(warnings.length == 2);
					//	TODO	test content of warnings
					$api.deprecate.warning = was;
				]]></script>
				<script type="application/x.jsapi#tests"><![CDATA[
					scenario( new function() {
						this.name = "deprecate";
						this.execute = function(scope) {
							var deprecate = $api.deprecate;

							//	TODO	Add a test somewhere in here where we attempt to set a deprecated property, do not really
							//			set it, and confirm that our callback receives the attempted (not actual) value
							var expectWarn = function(b) {
								var rv = function(content) {
									if (content.reason != deprecate) throw new Error("Not expected reason.");
									arguments.callee.actual = true;
								}
								rv.actual = false;
								rv.expect = b;
								rv.test = function() {
									return rv.actual == rv.expect;
								}
								rv.evaluate = function(message) {
									if (!message) {
										scope.test({
											success: this.test(),
											messages: {
												success: "expectWarn PASS: expect=" + rv.expect + " actual=" + rv.actual,
												failure: "expectWarn FAIL: expect=" + rv.expect + " actual=" + rv.actual
											}
										});
									} else {
										scope.test({
											success: this.test(),
											messages: {
												success: message + " passed.",
												failure: message + " FAILED."
											}
										})
									}
								}
								$api.deprecate.warning = rv;
								//$unit.context.setWarning(rv);
								return rv;
							}

							//	Each test either uses the jsunit Tests object or uses a custom console output
							//	Hook for execution environment to override console function
							var Tests;
							var test = function(f,message) {
								scope.test(f);
							}

							//
							//	Begin tests
							//

							var x = {
								foo: "bar",
								toString: function() {
									return "x1";
								}
							}

							var accessor = $platform && $platform.Object.defineProperty && $platform.Object.defineProperty.accessor;
							if (accessor) {
								deprecate(x,"foo");
								var yes = expectWarn(true);
								var z = x.foo;
								yes.evaluate("get x.foo");
							}
							//test(warning.test);

							//	Should FAIL
							//expectWarn(true);
							//test(warning.test);
							//

							//console("x1.foo = " + x.foo);
							if (accessor) {
								var yes = expectWarn(true);
								x.foo = "baz";
								yes.evaluate();
								scope.test({
									success: x.foo == "baz",
									messages: {
										success: "Value correct",
										failure: "Value " + x.foo
									}
								});
							}

							var yes = expectWarn(false);
							x.bar = "baz";
							yes.evaluate();

							if (accessor) {
								//console("x1.foo = " + x.foo);
								var x2 = new function() {
									this.foo = "bar";
									this.__defineSetter__("foo", function(value) {
										this.$foo = value;
									} );

									deprecate(this, "foo");
								}

								var yes = expectWarn(true);
								var z = x2.foo;
								yes.evaluate();

								var yes = expectWarn(true);
								x2.foo = "BAR";
								yes.evaluate();
								test(typeof(x2.foo) == "undefined", "Still undefined");

								var x3 = new function() {
									this.foo = 0;

									var foo = 0;

									this.__defineGetter__("foo", function() {
										return ++foo;
									} );

									deprecate(this, "foo");
								}

								var yes = expectWarn(true);
								var z = x3.foo;
								yes.evaluate();
								test(z > 0, "Getter-only value increasing.");
								test(x3.foo > z, "Getter-only value increasing.");

								var yes = expectWarn(true);
								x3.foo = 11;
								yes.evaluate();
								test(x3.foo != 11, "Cannot re-set once getter defined.");

								x3.__defineGetter__("foo", function() {
									return 42;
								});
								var yes = expectWarn(false);
								var z = x3.foo;
								yes.evaluate();
								test(x3.foo == 42, "Value is correct when getter redefined.");

								var x4 = new function() {
									var foo = 21;

									this.__defineGetter__("foo", function() {
										return foo;
									} );

									this.__defineSetter__("foo", function(value) {
										return (foo = value);
									} );

									deprecate(this, "foo");
								}

								var yes = expectWarn(true);
								var z = x4.foo;
								yes.evaluate();
								test(z == 21);
								test(x4.foo == 21);

								var yes = expectWarn(true);
								x4.foo = 14;
								yes.evaluate();
								test(x4.foo == 14);
							}

							var x5 = new function() {
								this.doIt = function() {
								}

								this.doItBetter = function() {
								}

								deprecate(this, "doIt");
							}

							var yes = expectWarn(true);
							x5.doIt();
							yes.evaluate();

							var yes = expectWarn(false);
							x5.doItBetter();
							yes.evaluate();
						}
					});
				]]></script>
			</li>
			<li class="function">
				<div class="name">experimental</div>
				<span>
					A function that can be used to mark a named property on an object as an experimental API. Its interface is
					exactly like that of <a href="#$api.deprecate"><code>deprecate</code></a>, including the presence of a
					<code>warning</code> callback that can receive information when an experimental API is used.
				</span>
			</li>
			<li class="object">
				<div class="name">Function</div>
				<span>__DESCRIPTION__</span>
				<div class="label">has properties:</div>
				<ul>
				</ul>
			</li>
		</ul>
	</div>
	<div>
		<h1>Exports</h1>
		<div>
			The platform loader is normally loaded within an environment-specific loader, so the following exports are not
			normally available to application code: they are available to the environment-specific loader.
		</div>
		<div class="type">
			<a class="type" name="types.code">code</a>
			<div>
				<div>
					<span class="type">string</span>
					<span>JavaScript code to execute.</span>
				</div>
				-OR-
				<div>
					<span class="type">function</span>
					<span>
						A function that can load the code and execute it inside a particular scope with a particular
						<code>this</code> object.
					</span>
					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="value">
								<span class="type">object</span>
								<span>
									The scope object inside which to execute the code, as if the code were executed
									with <code>with(arguments[0])</code>.
								</span>
							</li>
							<li class="value">
								<span class="type">object</span>
								<span>The object to use as <code>this</code> when executing the code.</span>
							</li>
						</ol>
					</div>
				</div>
			</div>
		</div>
		<div class="type" jsapi:id="Loader">
			<a class="type" name="types.Loader">Loader</a>
			<span jsapi:id="topdescription">A <i>Loader</i> loads and executes JavaScript code from a specific source.</span>
			<div class="label">has properties:</div>
			<ul>
				<li class="function" jsapi:id="run">
					<div class="name"><a name="Loader.run">run</a></div>
					<span jsapi:id="description">
						Executes code in a particular scope with a particular <code>this</code> value. The code will automatically
						contain the <code>$platform</code> and <code>$api</code> objects described above in its scope.
					</span>
					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="value">
								<span class="type">string</span>
								<span>The path of the code to execute.</span>
							</li>
							<li class="value" jsapi:id="arguments[1]">
								<span class="type">object</span>
								<span>The scope in which to execute the code.</span>
							</li>
							<li class="value" jsapi:id="arguments[2]">
								<span class="type">object</span>
								<span>The object to use as the <code>this</code> value when executing the code.</span>
							</li>
						</ol>
					</div>
				</li>
				<li class="function" jsapi:id="file">
					<div class="name"><a name="Loader.file">file</a></div>
					<span jsapi:id="description">
						Executes a script in a separate scope. The scope will contain the <code>$platform</code> and <code>$api</code>
						objects described above. In addition, the script will be provided with special objects named
						<code>$context</code> and <code>$exports</code>. The <code>$context</code> object represents an
						application-specific context to provide to the script; the <code>$exports</code> object represents an object to
						which the script can assign properties that will be visible outside the script.
					</span>
					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="value">
								<span class="type">string</span>
								<span>The path of the code to execute.</span>
							</li>
							<li class="value" jsapi:id="arguments[1]">
								<span class="type">object</span>
								<span>
									An object to use as the <code>$context</code> object when executing the given code. If absent, an
									empty object will be supplied.
									<!--	TODO	What about if it is a number, string, or boolean?	-->
								</span>
							</li>
						</ol>
					</div>
					<div class="returns" jsapi:id="returns">
						<div class="label">Returns</div>
						<span class="type">object</span>
						<span>An object which contains the properties the script assigned to the <code>$exports</code> object.</span>
					</div>
				</li>
				<li class="function" jsapi:id="module">
					<div class="name">module</div>
					<span jsapi:id="description">
						Loads a module. The module's code is specified by the first argument, and the second argument specifies
						objects to be supplied to the module when loading it.
					</span>
					<div jsapi:id="description2">
						The module's main file will be executed with the following variables in scope:
						<ul>
							<li>the <code>$platform</code> and <code>$api</code> objects specified above,</li>
							<li>the <code>$context</code> and <code>$exports</code> objects specified by the second argument,</li>
							<li>
								a <code>$loader</code> object of type <a href="#types.Loader">Loader</a> allowing other source
								files and submodules to be loaded.
							</li>
						</ul>
					</div>
					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="value">
								<span class="type">string</span>
								<span>The path of the code to execute.</span>
							</li>
							<li class="object" jsapi:id="arguments[1]">
								<span>
									(optional) An object specifying objects for the module. If no object is provided, an object will be
									created and supplied with default values for its properties as indicated below.
								</span>
								<div class="label">has properties:</div>
								<ul>
									<li class="value">
										<div class="name">$context</div>
										<span class="type">object</span>
										<span>
											(optional) The <code>$context</code> object to supply to the module's main file. If not
											provided, an empty object will be created and supplied.
										</span>
									</li>
									<li class="value">
										<div class="name">$exports</div>
										<span class="type">object</span>
										<span>
											(optional) The <code>$exports</code> object to supply to the module's main file. If not
											provided, an empty object will be created and supplied.
										</span>
									</li>
								</ul>
							</li>
						</ol>
					</div>
					<div class="returns" jsapi:id="returns">
						<div class="label">Returns</div>
						<span class="type">object</span>
						<span>An object containing this module's exports.</span>
					</div>
				</li>
			</ul>
		</div>

		<ul jsapi:id="global">
			<li class="function" jsapi:id="run">
				<div class="name">run</div>
				<span jsapi:id="description">
					Analogous to <a href="#Loader.run">Loader.run()</a>, except that the caller specifies a
					<a href="#types.code">code</a> to execute rather than a path within a <a href="#types.Loader">Loader</a>.
				</span>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li class="value">
							<span class="type"><a href="#types.code">code</a></span>
							<span>The code to execute.</span>
						</li>
						<li class="value" jsapi:id="arguments[1]">
							<span class="type">object</span>
							<span>See <a href="#Loader.run">Loader.run()</a>.</span>
						</li>
						<li class="value" jsapi:id="arguments[2]">
							<span class="type">object</span>
							<span>See <a href="#Loader.run">Loader.run()</a>.</span>
						</li>
					</ol>
				</div>
			</li>
			<li class="function" jsapi:id="file">
				<div class="name">file</div>
				<span jsapi:id="description">
					Analogous to <a href="#Loader.file">Loader.file()</a>, except that the caller specifies a
					<a href="#types.code">code</a> to execute rather than a path within a <a href="#types.Loader">Loader</a>.
				</span>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li class="value">
							<span class="type"><a href="#types.code">code</a></span>
							<span>The code to execute.</span>
						</li>
						<li class="value" jsapi:id="arguments[1]">
							<span class="type">object</span>
							<span>See <a href="#Loader.file">Loader.file()</a>.</span>
						</li>
					</ol>
				</div>
				<div class="returns" jsapi:id="returns">
					<div class="label">Returns</div>
					<span>See <a href="#Loader.file">Loader.file()</a>.</span>
				</div>
			</li>
			<li class="function" jsapi:id="module">
				<div class="name"><a name="exports.module">module</a></div>
				<span jsapi:id="description">
					Analogous to <a href="#Loader.module">Loader.module()</a>, except that the caller specifies information about
					the module structure and how to load the code rather than a path within a <a href="#types.Loader">Loader</a>.
				</span>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li class="object">
							<span>An object specifying the format of the module and how to load it.</span>
							<p>
								Ordinarily, the loader loads the main file by calling the <code>getCode</code> method with the
								string value of the <code>main</code> property, and then executing the resulting code with the
								appropriate <code>$context</code> and <code>$exports</code>.
								<!--
									Below outdated; may now be part of decorateLoader
								However, the <code>instantiate</code>
								method, if defined, can override the behavior of <code>getCode</code>. See the definition of
								<code>instantiate</code> for details.
								-->
							</p>
							<div class="label">has properties:</div>
							<ul>
								<li class="value">
									<div class="name">main</div>
									<span class="type">string</span>
									<span>
										The path of the module's main file: the file that is executed first, and loads the other
										files (if any).
									</span>
								</li>
								<li class="function">
									<div class="name">getCode</div>
									<span>Loads the source files of this module.</span>
									<div class="arguments">
										<div class="label">Arguments</div>
										<ol>
											<li class="value">
												<span class="type">string</span>
												<span>A file name or path, delimited by slashes (<code>/</code>).</span>
											</li>
										</ol>
									</div>
									<div class="returns">
										<div class="label">Returns</div>
										<span class="type"><a href="#types.code">code</a></span>
										<span>The code located at the given location in this module.</span>
									</div>
								</li>
								<li class="constructor">
									<div class="name">Child</div>
									<span>
										(optional)
										Creates a child loader for use in loading modules within this loader.
										If omitted, an implementation will be supplied that uses the <code>getCode</code> method
										with a prefix attached.
									</span>
									<div class="arguments">
										<div class="label">Arguments</div>
										<ol>
											<li class="value">
												<span class="type">string</span>
												<span>A prefix to use when loading the resources of the child.</span>
											</li>
										</ol>
									</div>
									<div class="instances">
										<div class="label">Instances</div>
										<span class="type"><a href="#types.Loader">Loader</a></span>
										<span>A loader that loads code for a child loader.</span>
									</div>
								</li>
							</ul>
						</li>
						<li class="object" jsapi:id="arguments[1]">
							<span>
								See <a href="#Loader.module">Loader.module()</a>.
							</span>
						</li>
					</ol>
				</div>
				<div class="returns" jsapi:id="returns">
					<div class="label">Returns</div>
					See <a href="#types.Loader">Loader.module()</a>.
				</div>
			</li>
			<li class="constructor">
				<div class="name"><a name="exports.Loader">Loader</a></div>
				<span>Creates a <a href="#types.Loader">Loader</a>.</span>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li class="object">
							<div class="label">has properties:</div>
							<ul>
								<li class="function">
									<div class="name">getCode</div>
									<span>Locates JavaScript code to execute given a path.</span>
									<div class="arguments">
										<div class="label">Arguments</div>
										<ol>
											<li class="value">
												<span class="type">string</span>
												<span>A path.</span>
											</li>
										</ol>
									</div>
									<div class="returns">
										<div class="label">Returns</div>
										<span class="type"><a href="#types.code">code</a></span>
									</div>
								</li>
								<li class="constructor">
									<div class="name">Child</div>
									<span>
										A constructor invoked when a child loader is created.
									</span>
									<div class="arguments">
										<div class="label">Arguments</div>
										<ol>
											<li class="value">
												<span class="type">string</span>
												<span>A path relative to the parent loader to use as the base for loading code.</span>
											</li>
										</ol>
									</div>
									<div class="instances">
										<div class="label">Instances</div>
										<span class="type"><a href="#types.Loader">Loader</a></span>
									</div>
								</li>
							</ul>
						</li>
					</ol>
				</div>
				<div class="instances">
					<div class="label">Instances</div>
					<span class="type"><a href="#types.Loader">Loader</a></span>
				</div>
			</li>
			<li class="function" jsapi:id="namespace">
				<div class="name">namespace</div>
				<!--
				TODO	this documentation copied from older version; merge with below

				Creates a <i>namespace</i>, a scope object that has a given position in the global scope. For example, a
				namespace named "inonit.foo.bar" is the <code>bar</code> property of an object which is the <code>foo</code>
				property of another object which is in turn the <code>inonit</code> property of the global object.
				<div>
					If some or all of the named properties exist, the existing ones will be used; they will not be created. Thus, if
					the global object already has an <code>inonit</code> property, and that object has a <code>foo</code> property,
					but the <code>inonit.foo</code> object does not have a <code>bar</code> property, a single object will be
					created and assigned to the <code>bar</code> property of the existing <code>inonit.foo</code> object.
				</div>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li><span class="type">string</span> The name of the namespace to create (or return if it exists).</li>
					</ol>
				</div>
				<div class="returns">
					<div class="label">Returns</div>
					<span class="type">object</span> A namespace located at the given name.
				</div>
				-->
				<span>
					Creates a <i>namespace</i>. A namespace is an object which is globally visible because it is rooted to the
					global object (e.g., <code>window</code> in the browser). So, in the browser, the namespace
					<code>inonit.foo.bar</code> would be an object that is the <code>bar</code> property of an object that is the
					<code>foo</code> property of an object that is the <code>inonit</code> property of <code>window</code>. It could
					be referenced as <code>inonit.foo.bar</code> in JavaScript code, or alternatively as
					<code>window.inonit.foo.bar</code> in the browser.
				</span>
				<p>
					In the event portions of the sequence of rooting objects do not exist, they will be created. So, for example, in
					the browser-based example above, if the <code>window.inonit</code> object exists, but the
					<code>window.inonit</code> object does not have a property named <code>foo</code>, an object will be created
					and assigned to the <code>foo</code> property of <code>window.inonit</code>, and then an object will be created
					and assigned to that object's <code>bar</code> property.
				</p>
				<p>
					If the full sequence of rooting objects exists, the object at the given location will be returned.
				</p>
				<div class="arguments">
					<div class="label">Arguments</div>
					<ol>
						<li class="value">
							<span class="type">string</span>
							<span>The name/location of the namespace to create.</span>
						</li>
					</ol>
				</div>
				<div class="returns">
					<div class="label">Returns</div>
					<span class="type">object</span>
					<span>
						The object at the specified location. The object (and its parents) will be created if it does not
						exist.
					</span>
				</div>
			</li>
			<li class="object">
				<div class="name">java</div>
				<span>The same object as <code>$platform.java</code>.</span>
			</li>
			<li class="object">
				<div class="name">$platform</div>
				<span>The same object as <code>$platform</code>.</span>
			</li>
			<li class="object">
				<div class="name">$api</div>
				<span>The same object as <code>$api</code>.</span>
			</li>
		</ul>
	</div>
</body>
</html>