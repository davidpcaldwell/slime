<!--
LICENSE
This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not
distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.

The Original Code is the SLIME loader infrastructure.

The Initial Developer of the Original Code is David P. Caldwell <david@davidpcaldwell.com>.
Portions created by the Initial Developer are Copyright (C) 2013 the Initial Developer. All Rights Reserved.

Contributor(s):
END LICENSE
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:jsapi="http://www.inonit.com/jsapi">
<head>
	<title>__TITLE__</title>
	<!--	TODO	change these to use local copies of these files at the appropriate location	-->
	<!--
		These files are specified using http: rather than https: because githack.com will redirect them to https:, but http: will
		work when using an HTTP proxy to serve local copies of the files without needing to run https: locally
	-->
	<link href="http://bb.githack.com/davidpcaldwell/slime/raw/tip/loader/api/api.css" rel="stylesheet" type="text/css" />
	<script src="http://bb.githack.com/davidpcaldwell/slime/raw/tip/loader/api/api.js"></script>
	<script>
		//	TODO	CORS
		document.domain = document.domain;
	</script>
</head>
<body>
	<div>__DESCRIPTION__</div>
	<div>
		<h1>Context</h1>
		<ul>
		</ul>
	</div>
	<div>
		<h1>Exports</h1>
		<div jsapi:id="exports">
			<ul>
				<script type="application/x.jsapi#initialize"><![CDATA[
					scope.isRhino = Boolean(typeof(Packages.org.mozilla.javascript.Context) == "function"
						&& (Packages.org.mozilla.javascript.Context.getCurrentContext() != null))
					;
				]]></script>
				<script type="application/x.jsapi#tests">
					verify(api).is.type("object");
					verify(api).java.is.type("object");

					//	Verify and document JS engine differences

					var typeofJavaInteger = (isRhino) ? "object" : "number";
					var i = new Packages.java.lang.Integer(8);
					verify(i.wait).is.type("function");
					verify(i.foo).is.type("undefined");
					verify(typeof(i)).is(typeofJavaInteger);

					var javaObjectMethodTypeOnPrimitive = (isRhino) ? "undefined" : "function";
					var n = 8;
					verify(n.wait,"number.wait").is.type(javaObjectMethodTypeOnPrimitive);
					var s = "string";
					verify(s.wait,"string.wait").is.type(javaObjectMethodTypeOnPrimitive);
				</script>
				<li class="function" jsapi:id="getClass">
					<div class="name">getClass</div>
					<span>
						Returns a Java class given its name. Note that the name expected is the VM-level class name, not the
						source-level class name. So for inner class <code>Baz</code> of class <code>foo.Bar</code>, the argument given
						should be <code>"foo.Bar$Baz"</code>.
					</span>
					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="value">
								<span class="type">string</span>
								<span>The name of a Java class.</span>
							</li>
						</ol>
					</div>
					<div class="returns">
						<div class="label">Returns</div>
						<span class="type">JavaClass</span>
						<span>
							The JavaClass representing the Java class with the given name, or <code>null</code> if no such class
							exists.
						</span>
					</div>
					<script type="application/x.jsapi#tests">
						var ObjectType = api.java.getClass("java.lang.Object");
						verify(ObjectType).is.type("function");
						var Object = api.java.toNativeClass(ObjectType);
						verify(Object).is.type("object");
						verify(Object).evaluate(function() { return String(this.getName()); }).is("java.lang.Object");
						verify(Object).evaluate(function() { return String(this.getSimpleName()); }).is("Object");


						var Foo = api.java.getClass("foo.bar.Baz");
						verify(Foo).is(null);

						verify(api).java.getClass("inonit.script.runtime.io.Streams").is.type("function");
						verify(api).java.getClass("inonit.script.runtime.io.Streams$Null").is.type("function");
						verify(api).java.evaluate(function() { return String(this.getClass("inonit.script.runtime.io.Streams$Null")); }).is("[JavaClass inonit.script.runtime.io.Streams$Null]");
						verify(api).java.getClass("inonit.script.runtime.io.Streams.Null").is.type("null");
					</script>
				</li>
				<li class="function" jsapi:id="isJavaObject">
					<div class="name">isJavaObject</div>
					<span>A method that can be used to determine whether a given value is a native Java host object.</span>
					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="value">
								<span class="type">(any)</span>
								<span>A value.</span>
							</li>
						</ol>
					</div>
					<div class="returns">
						<div class="label">Returns</div>
						<span class="type">boolean</span>
						<span><code>true</code> if the given value is a native Java object.</span>
						<!--	TODO	What about JavaPackage? JavaClass?	-->
					</div>
					<script type="application/x.jsapi#tests">
						verify(api).java.isJavaObject(Packages.java.lang.Runtime.getRuntime()).is(true);
						verify(api).java.isJavaObject(new Packages.java.lang.Object()).is(true);
						verify(api).java.isJavaObject(Packages.java.lang.Character.UnicodeBlock.GREEK).is(true);
						verify(api).java.isJavaObject(Packages.java.lang.reflect.Array.newInstance(api.java.toNativeClass(Packages.java.lang.Object),0)).is(true);

						verify(api).java.isJavaObject(void(0)).is(false);
						verify(api).java.isJavaObject(null).is(false);
						verify(api).java.isJavaObject(false).is(false);
						verify(api).java.isJavaObject(1).is(false);
						verify(api).java.isJavaObject(1.0).is(false);
						verify(api).java.isJavaObject("foo").is(false);
						verify(api).java.isJavaObject({}).is(false);

						verify(api).java.isJavaObject(new Packages.java.lang.String("hello world")).is(isRhino);
						verify(api).java.isJavaObject(new Packages.java.lang.Integer(4)).is(isRhino);
						verify(api).java.isJavaObject(new Packages.java.lang.Boolean(true)).is(isRhino);
					</script>
				</li>
				<li class="function" jsapi:id="isJavaType">
					<div class="name">isJavaType</div>
					<span>
						A function that creates a function that can determine whether that function's
						argument is of the given Java type.
					</span>
					<div class="type">
						<a class="type" name="types.isJavaType.Filter">Filter</a>
						<span class="type">function</span>
						<div class="function">
							<span>A function that determines whether its argument is of a certain Java type.</span>
							<div class="arguments">
								<div class="label">Arguments</div>
								<ol>
									<li class="value">
										<span class="type">(any)</span>
										<span>A value.</span>
									</li>
								</ol>
							</div>
							<div class="returns">
								<div class="label">Returns</div>
								<span class="type">boolean</span>
								<span>
									<code>true</code> if the value is a Java object which is an instance of the given class;
									<code>false</code> otherwise.
								</span>
							</div>
						</div>
					</div>

					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="value">
								<span class="type">JavaClass</span>
								<span>A Java type.</span>
							</li>
						</ol>
					</div>
					<div class="returns">
						<div class="label">Returns</div>
						<span class="type"><a href="#types.isJavaType.Filter">Filter</a></span>
						<span>A function that can determine whether its argument is of the given type.</span>
					</div>
					<script type="application/x.jsapi#tests">
						var filters = {
							Object: api.java.isJavaType(Packages.java.lang.Object),
							Runnable: api.java.isJavaType(Packages.java.lang.Runnable),
							OutputStream: api.java.isJavaType(Packages.java.io.OutputStream),
							InputStream: api.java.isJavaType(Packages.java.io.InputStream)
						};

						verify(filters.Object(new Packages.java.lang.Object()),"Object/Object").is(true);
						verify(filters.Runnable(new Packages.java.lang.Thread())).is(true);
						verify(filters.OutputStream(new Packages.java.io.ByteArrayOutputStream())).is(true);
						verify(filters.InputStream(new Packages.java.io.ByteArrayOutputStream())).is(false);

						verify(filters.Object(new Packages.java.lang.Integer(8))).is(isRhino);
						verify(filters.Object(new Packages.java.lang.String("8"))).is(isRhino);
						verify(filters.Object(new Packages.java.lang.Boolean(true))).is(isRhino);
					</script>
				</li>
				<li class="function" jsapi:id="toNativeClass">
					<div class="name">toNativeClass</div>
					<span>__DESCRIPTION__</span>
					<div class="arguments">
						<div class="label">Arguments</div>
						<ol>
							<li class="value">
								<span class="type">JavaClass</span>
								<span>A JavaClass object.</span>
							</li>
						</ol>
					</div>
					<div class="returns">
						<div class="label">Returns</div>
						<span class="type"><code>Packages.java.lang.Class</code></span>
						<span>The native Java class corresponding to the given class.</span>
					</div>
					<script type="application/x.jsapi#tests">
						var Object = api.java.toNativeClass(Packages.java.lang.Object);
						verify(Object).is.type("object");
						verify(Object).evaluate(function() { return String(this.getName()); }).is("java.lang.Object");
						verify(Object).evaluate(function() { return String(this.getSimpleName()); }).is("Object");
					</script>
				</li>
			</ul>
		</div>
	</div>
</body>
</html>